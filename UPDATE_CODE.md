# ä»£ç æ›´æ–°è„šæœ¬è¯´æ˜

é¡¹ç›®æä¾›äº†å¤šä¸ªè„šæœ¬ç”¨äºæ›´æ–°è¿œç¨‹æœåŠ¡å™¨çš„ä»£ç ï¼Œæ ¹æ®éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ–¹å¼ã€‚

## è„šæœ¬åˆ—è¡¨

### 1. quick-update.sh - å¿«é€Ÿæ›´æ–°ï¼ˆæ¨èæ—¥å¸¸ä½¿ç”¨ï¼‰

**åŠŸèƒ½**: ä½¿ç”¨rsyncå¿«é€ŸåŒæ­¥ä»£ç æ–‡ä»¶ï¼Œä¸é‡æ–°æ„å»º

**ç‰¹ç‚¹**:
- âš¡ æœ€å¿« - åªä¼ è¾“å˜æ›´çš„æ–‡ä»¶
- ğŸ”„ å¢é‡æ›´æ–°
- ğŸ“¦ ä¸é‡æ–°æ„å»ºï¼Œé€‚åˆå¿«é€Ÿæµ‹è¯•

**ä½¿ç”¨æ–¹æ³•**:
```bash
# æ›´æ–°å…¨éƒ¨
./quick-update.sh

# åªæ›´æ–°åç«¯
./quick-update.sh backend

# åªæ›´æ–°å‰ç«¯
./quick-update.sh frontend
```

**é€‚ç”¨åœºæ™¯**:
- æ—¥å¸¸å¼€å‘å¿«é€Ÿæµ‹è¯•
- åªä¿®æ”¹äº†ä»£ç ï¼Œä¸éœ€è¦é‡æ–°æ„å»º
- éœ€è¦å¿«é€Ÿçœ‹åˆ°æ•ˆæœ

---

### 2. update-code.sh - æ›´æ–°ä»£ç ï¼ˆä¸è‡ªåŠ¨éƒ¨ç½²ï¼‰

**åŠŸèƒ½**: æ‰“åŒ…å¹¶ä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨ï¼Œä½†ä¸è‡ªåŠ¨é‡æ–°æ„å»ºéƒ¨ç½²

**ç‰¹ç‚¹**:
- ğŸ“¦ æ‰“åŒ…ä¼ è¾“
- ğŸ’¾ è‡ªåŠ¨å¤‡ä»½æ—§ä»£ç 
- ğŸ”§ éœ€è¦æ‰‹åŠ¨é‡æ–°æ„å»º

**ä½¿ç”¨æ–¹æ³•**:
```bash
# æ›´æ–°å…¨éƒ¨
./update-code.sh

# åªæ›´æ–°åç«¯
./update-code.sh backend

# åªæ›´æ–°å‰ç«¯
./update-code.sh frontend
```

**é€‚ç”¨åœºæ™¯**:
- éœ€è¦å¤‡ä»½æ—§ä»£ç 
- æƒ³æ‰‹åŠ¨æ§åˆ¶éƒ¨ç½²è¿‡ç¨‹
- éœ€è¦å…ˆæ£€æŸ¥ä»£ç å†éƒ¨ç½²

---

### 3. update-and-deploy.sh - æ›´æ–°å¹¶è‡ªåŠ¨éƒ¨ç½²ï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒï¼‰

**åŠŸèƒ½**: æ›´æ–°ä»£ç å¹¶è‡ªåŠ¨é‡æ–°æ„å»ºéƒ¨ç½²

**ç‰¹ç‚¹**:
- ğŸ“¦ æ‰“åŒ…ä¼ è¾“
- ğŸ’¾ è‡ªåŠ¨å¤‡ä»½
- ğŸš€ è‡ªåŠ¨é‡æ–°æ„å»ºDockeré•œåƒ
- ğŸ”„ è‡ªåŠ¨é‡å¯æœåŠ¡
- ğŸ“Š æ˜¾ç¤ºæœåŠ¡çŠ¶æ€å’Œæ—¥å¿—

**ä½¿ç”¨æ–¹æ³•**:
```bash
# æ›´æ–°å¹¶éƒ¨ç½²å…¨éƒ¨
./update-and-deploy.sh

# åªæ›´æ–°å¹¶éƒ¨ç½²åç«¯
./update-and-deploy.sh backend

# åªæ›´æ–°å‰ç«¯ï¼ˆå‰ç«¯é€šå¸¸ä¸éœ€è¦Dockerï¼‰
./update-and-deploy.sh frontend
```

**é€‚ç”¨åœºæ™¯**:
- ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- éœ€è¦é‡æ–°æ„å»ºé•œåƒ
- éœ€è¦è‡ªåŠ¨é‡å¯æœåŠ¡
- æ­£å¼å‘å¸ƒ

---

## ä½¿ç”¨å¯¹æ¯”

| è„šæœ¬ | é€Ÿåº¦ | è‡ªåŠ¨æ„å»º | è‡ªåŠ¨éƒ¨ç½² | å¤‡ä»½ | é€‚ç”¨åœºæ™¯ |
|------|------|----------|----------|------|----------|
| `quick-update.sh` | âš¡âš¡âš¡ æœ€å¿« | âŒ | âŒ | âŒ | æ—¥å¸¸å¼€å‘ |
| `update-code.sh` | âš¡âš¡ è¾ƒå¿« | âŒ | âŒ | âœ… | æ‰‹åŠ¨éƒ¨ç½² |
| `update-and-deploy.sh` | âš¡ è¾ƒæ…¢ | âœ… | âœ… | âœ… | ç”Ÿäº§ç¯å¢ƒ |

## ä½¿ç”¨ç¤ºä¾‹

### æ—¥å¸¸å¼€å‘æµç¨‹

```bash
# 1. ä¿®æ”¹ä»£ç åï¼Œå¿«é€ŸåŒæ­¥æµ‹è¯•
./quick-update.sh backend

# 2. SSHåˆ°æœåŠ¡å™¨æ‰‹åŠ¨é‡å¯ï¼ˆå¦‚æœéœ€è¦ï¼‰
ssh -i ~/Desktop/chuchang/chuchang.pem root@39.105.136.116
cd /opt/admin-system
docker-compose restart backend
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æµç¨‹

```bash
# 1. æ›´æ–°å¹¶è‡ªåŠ¨éƒ¨ç½²
./update-and-deploy.sh

# 2. æ£€æŸ¥æœåŠ¡çŠ¶æ€
ssh -i ~/Desktop/chuchang/chuchang.pem root@39.105.136.116
cd /opt/admin-system
docker-compose ps
docker-compose logs -f backend
```

### åªæ›´æ–°å‰ç«¯

```bash
# å¿«é€Ÿæ›´æ–°å‰ç«¯ä»£ç 
./quick-update.sh frontend

# å¦‚æœéœ€è¦é‡æ–°æ„å»º
ssh -i ~/Desktop/chuchang/chuchang.pem root@39.105.136.116
cd /opt/admin-system/frontend
npm install
npm run build
```

## æ³¨æ„äº‹é¡¹

### 1. ç¯å¢ƒå˜é‡æ–‡ä»¶

æ‰€æœ‰è„šæœ¬éƒ½ä¼šæ’é™¤ `.env` æ–‡ä»¶ï¼Œä¸ä¼šè¦†ç›–æœåŠ¡å™¨ä¸Šçš„é…ç½®ã€‚

### 2. ä¾èµ–æ–‡ä»¶

- **åç«¯**: `go.sum` ä¼šè¢«æ’é™¤ï¼ŒæœåŠ¡å™¨ä¸Šä¼šè‡ªåŠ¨è¿è¡Œ `go mod download`
- **å‰ç«¯**: `node_modules` å’Œ `dist` ä¼šè¢«æ’é™¤ï¼ŒæœåŠ¡å™¨ä¸Šéœ€è¦è¿è¡Œ `npm install`

### 3. å¤‡ä»½

`update-code.sh` å’Œ `update-and-deploy.sh` ä¼šè‡ªåŠ¨å¤‡ä»½æ—§ä»£ç åˆ° `/tmp/` ç›®å½•ã€‚

### 4. æœåŠ¡é‡å¯

- `quick-update.sh`: ä¸é‡å¯æœåŠ¡ï¼Œéœ€è¦æ‰‹åŠ¨é‡å¯
- `update-code.sh`: ä¸é‡å¯æœåŠ¡ï¼Œéœ€è¦æ‰‹åŠ¨é‡å¯
- `update-and-deploy.sh`: è‡ªåŠ¨é‡å¯æœåŠ¡

## æ‰‹åŠ¨é‡å¯æœåŠ¡

å¦‚æœéœ€è¦æ‰‹åŠ¨é‡å¯æœåŠ¡ï¼š

```bash
# SSHç™»å½•æœåŠ¡å™¨
ssh -i ~/Desktop/chuchang/chuchang.pem root@39.105.136.116

# è¿›å…¥é¡¹ç›®ç›®å½•
cd /opt/admin-system

# é‡å¯åç«¯æœåŠ¡
docker-compose restart backend

# æˆ–é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose build backend
docker-compose up -d backend

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f backend
```

## æ•…éšœæ’æŸ¥

### é—®é¢˜1: è¿æ¥å¤±è´¥

```bash
# æ£€æŸ¥SSHè¿æ¥
./test-ssh.sh

# æ£€æŸ¥å¯†é’¥æ–‡ä»¶
ls -la ~/Desktop/chuchang/chuchang.pem
```

### é—®é¢˜2: æ–‡ä»¶åŒæ­¥å¤±è´¥

```bash
# æ£€æŸ¥æœåŠ¡å™¨ç£ç›˜ç©ºé—´
ssh -i ~/Desktop/chuchang/chuchang.pem root@39.105.136.116 "df -h"

# æ£€æŸ¥ç›®å½•æƒé™
ssh -i ~/Desktop/chuchang/chuchang.pem root@39.105.136.116 "ls -la /opt/admin-system"
```

### é—®é¢˜3: æœåŠ¡å¯åŠ¨å¤±è´¥

```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
ssh -i ~/Desktop/chuchang/chuchang.pem root@39.105.136.116
cd /opt/admin-system
docker-compose logs backend

# æ£€æŸ¥é…ç½®æ–‡ä»¶
cat .env
```

## æœ€ä½³å®è·µ

1. **å¼€å‘é˜¶æ®µ**: ä½¿ç”¨ `quick-update.sh` å¿«é€Ÿè¿­ä»£
2. **æµ‹è¯•é˜¶æ®µ**: ä½¿ç”¨ `update-code.sh` æ‰‹åŠ¨æ§åˆ¶éƒ¨ç½²
3. **ç”Ÿäº§ç¯å¢ƒ**: ä½¿ç”¨ `update-and-deploy.sh` è‡ªåŠ¨éƒ¨ç½²
4. **é‡è¦æ›´æ–°**: å…ˆå¤‡ä»½ï¼Œå†éƒ¨ç½²
5. **éƒ¨ç½²å**: æ£€æŸ¥æ—¥å¿—å’ŒæœåŠ¡çŠ¶æ€

